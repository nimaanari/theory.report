<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0RQ5M78VX5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-0RQ5M78VX5');
  </script>
  <meta charset='utf-8'>
  <meta name='generator' content='<%= Pluto.generator %>'>

  <title><%= site.title %></title>

  <link rel="alternate" type="application/rss+xml" title="Posts (RSS)" href="rss20.xml" />
  <link rel="alternate" type="application/atom+xml" title="Posts (Atom)" href="atom.xml" />
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  <%= stylesheet_link_tag 'css/font-awesome' %>
  <%= stylesheet_link_tag 'css/blank' %>
</head>
<body>
  <div id='navwrap'>
    <div id='nav'>
      <p>
        Last Update
      </p>
      <p class='small'>
        <% if site.updated %>
          <time class='timeago' datetime="<%= site.updated.iso8601 %>"><%= site.updated.strftime('%A, %B %d %Y, %H:%M') %></time>
        <% end %>
      </p>

      <p>Feeds</p>
      <ul class='subscriptions small' >
      <% site.feeds.each do |feed| %>
        <li>
          <%= link_to( image_tag('i/feed.png'), feed.feed_url ) %>
          <%= link_to feed.title, feed.url %>
          <%= link_to '', "http://twitter.com/#{feed.twitter}", :title => "@#{feed.twitter} on twitter", :class => "icon-twitter" if feed.twitter %>
        </li>
      <% end %>
      </ul>

      <p class='small'><a href="opml.xml">OPML feed</a> of all feeds.</p>
      <p class='small'>Subscribe to the <a href="atom.xml">Atom feed</a> or <a href="rss20.xml">RSS feed</a> to stay up to date.</p>
      <p class='small'>Source on <a href="https://github.com/nimaanari/theory.report">GitHub</a>.</p>
      <p class='small'>Powered by <a href='https://github.com/feedreader'>Pluto</a>.</p>
    </div>
  </div>

  <div id='opts'>
    <div style='width: 100%; text-align: right;'>
    <img src='i/view-headlines.png' id='show-headlines' title='Show Headlines Only' width='24' height='24'>
    <img src='i/view-snippets.png' id='show-snippets' title='Show Snippets' width='24' height='24'>
    <img src='i/view-standard.png' id='show-fulltext' title='Show Full Text' width='24' height='24'>
    </div>
  </div>

  <h1>
    <%= site.title %>
  </h1>

  <div id="articles">
    <%
      items = site.items.latest.limit(50)
      ItemCursor.new( items ).each do |item, new_date, new_feed|
    %>
    <% if new_date %>
    <h2 class='new-date'>
      <i class='icon-calendar-empty'></i> <%= item.updated.strftime('%A, %B %d') %>
    </h2>
    <% end %>

    <article class='item'>
      <div class='item-header'>
        <span class='item-caret'>
          <i class='icon-large icon-caret-down item-collapse item-close item-opened'></i>
          <i class='icon-large icon-caret-right item-expand item-open item-closed'></i>
        </span>
        <span class='item-info'>
          <h3 class='item-title'><%= link_to item.title, item.url %></h3>
          <p class='item-feed'>from <%= link_to item.feed.title, item.feed.url %></p>
        </span>
      </div>

      <div class='item-body'>
        <div class='item-snippet'>
        <% if item.summary %>
          <%= textify( item.summary )[0..400] %>
        <% elsif item.content %>
          <%= textify( item.content )[0..400] %>
        <% else %>
          -/-
        <% end %>
        </div>

        <div class='item-content item-summary'>
        <% if item.content %>
          <% textify( item.content ) %>
          <%= item.content %>
        <% elsif item.summary %>
          <% textify( item.summary ) %>
          <%= item.summary %>
        <% else %>
          -/-
        <% end %>
        </div>

        <div class='item-footer'>
          <time class='timeago' datetime="<%= item.updated.iso8601 %>"><%= item.updated.strftime('%A, %B %d %Y, %H:%M') %></time>
        </div>
      </div>
    </article>
  <% end %>
  </div>

  <script src='js/jquery-2.0.3.min.js'></script>
  <script src="js/jquery.timeago.js" type="text/javascript"></script>
  <script>
    jQuery(document).ready(function() {
      jQuery("time.timeago").timeago();
    });
  </script>
  <script src='js/blank.js'></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
